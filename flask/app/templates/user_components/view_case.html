<!-- app/templates/client_components/view_case.html -->
<div class="view-case-page container">

  <!-- פרטי תיק -->
  <section class="info-card position-relative">
    <h5>פרטי תיק</h5>
    <button class="btn btn-outline-primary btn-sm position-absolute top-0 end-0 m-2"
            onclick="openEditCaseModal('case')">ערוך</button>
    <div class="row g-3">
      <div class="col-md-4">
        <label>מספר סידורי</label>
        <input id="case-serial" class="form-control readonly" readonly>
      </div>
      <div class="col-md-4">
        <label>תאריך יצירה</label>
        <input id="case-created-at" class="form-control readonly" readonly>
      </div>
      <div class="col-md-4">
        <label>סטטוס</label>
        <input id="case-status" class="form-control readonly" readonly>
      </div>
      <div class="col-md-4">
        <label>כותרת</label>
        <input id="case-title" class="form-control readonly" readonly>
      </div>
      <div class="col-md-4">
        <label>קטגוריה</label>
        <input id="case-category" class="form-control readonly" readonly>
      </div>
      <div class="col-md-4">
        <label>עובדות התיק</label>
        <input id="case-facts" class="form-control readonly" readonly>
      </div>
    </div>
  </section>

  <!-- פרטי לקוח -->
  <section class="info-card position-relative">
    <h5>פרטי לקוח</h5>
    <button class="btn btn-outline-primary btn-sm position-absolute top-0 end-0 m-2"
            onclick="openEditCaseModal('client')">ערוך</button>
    <div class="row g-3">
      <div class="col-md-4">
        <label>מספר סידורי</label>
        <input id="client-serial" class="form-control readonly" readonly>
      </div>
      <div class="col-md-4">
        <label>תאריך יצירה</label>
        <input id="client-created-at" class="form-control readonly" readonly>
      </div>
      <div class="col-md-4">
        <label>תעודת זהות</label>
        <input id="client-id-card-number" class="form-control readonly" readonly>
      </div>
      <div class="col-md-4">
        <label>שם פרטי</label>
        <input id="client-first-name" class="form-control readonly" readonly>
      </div>
      <div class="col-md-4">
        <label>שם משפחה</label>
        <input id="client-last-name" class="form-control readonly" readonly>
      </div>
      <div class="col-md-4">
        <label>טלפון</label>
        <input id="client-phone" class="form-control readonly" readonly>
      </div>
      <div class="col-md-4">
        <label>אימייל</label>
        <input id="client-email" class="form-control readonly" readonly>
      </div>
      <div class="col-md-4">
        <label>עיר</label>
        <input id="client-city" class="form-control readonly" readonly>
      </div>
      <div class="col-md-4">
        <label>רחוב</label>
        <input id="client-street" class="form-control readonly" readonly>
      </div>
      <div class="col-md-4">
        <label>מספר רחוב</label>
        <input id="client-street-number" class="form-control readonly" readonly>
      </div>
      <div class="col-md-4">
        <label>מיקוד</label>
        <input id="client-postal-code" class="form-control readonly" readonly>
      </div>
    </div>
  </section>

  <!-- קבצים -->
  <section class="info-card position-relative">
    <h5>קבצים מצורפים</h5>
    <button class="btn btn-outline-success btn-sm position-absolute top-0 end-0 m-2"
          onclick="openAddFileModal()">➕ הוסף קבצים</button>
    <div class="table-responsive">
      <table class="table table-sm table-striped text-center" id="case-files">
        <thead class="table-light">
          <tr>
            <th>שם קובץ</th>
            <th>הורדה</th>
          </tr>
        </thead>
        <tbody>
          <tr><td colspan="100%" class="text-muted">אין קבצים זמינים</td></tr>
        </tbody>
      </table>
    </div>
  </section>
</div>

<!-- Modal עריכת פרטי תיק -->
<div class="modal fade" id="editCaseModal" tabindex="-1" aria-labelledby="editCaseModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title" id="editCaseModalLabel">עריכת פרטי תיק</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="editCaseForm" class="row g-2">
          <input type="hidden" name="serial" id="edit-case-serial">

          <div class="col-12">
            <label class="form-label">כותרת</label>
            <input id="edit-case-title" name="title" class="form-control">
          </div>

          <div class="col-12">
            <label class="form-label">קטגוריה</label>
            <select id="edit-case-category" name="category" class="form-select"></select>
          </div>

          <div class="col-12">
            <label class="form-label">סטטוס</label>
            <select id="edit-case-status" name="status" class="form-select"></select>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">בטל</button>
        <button type="button" class="btn btn-primary btn-sm" id="saveEditCaseBtn">שמור</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal עריכת פרטי לקוח -->
<div class="modal fade" id="editClientModal" tabindex="-1" aria-labelledby="editClientModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title" id="editClientModalLabel">עריכת פרטי לקוח</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="editClientForm" class="row g-2">
          <input type="hidden" name="serial" id="edit-client-serial">
          <div class="col-12">
            <label class="form-label">שם</label>
            <input id="edit-client-name" name="client_name" class="form-control">
          </div>
          <div class="col-12">
            <label class="form-label">תעודת זהות</label>
            <input id="edit-client-id" name="client_id" class="form-control">
          </div>
          <div class="col-12">
            <label class="form-label">טלפון</label>
            <input id="edit-client-phone" name="client_phone" class="form-control">
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">בטל</button>
        <button type="button" class="btn btn-primary btn-sm" id="saveEditClientBtn">שמור</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal העלאת קבצים -->
<div class="modal fade" id="addFileModal" tabindex="-1" aria-labelledby="addFileModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title" id="addFileModalLabel">הוספת קבצים לתיק</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">

        <form id="addFileForm" enctype="multipart/form-data">
          <input type="hidden" name="serial" id="add-files-serial">

          <div id="drop-area">
            גרור קבצים לכאן או לחץ לבחירה
            <input type="file" id="fileElem" hidden multiple>
          </div>

          <table class="table table-striped table-sm mt-3" id="fileTable">
            <thead class="table-light">
              <tr>
                <th>שם קובץ</th>
                <th>ביטול</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>

          <input type="file" name="files" id="realFileInput" hidden multiple>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary btn-sm" data-bs-dismiss="modal">בטל</button>
        <button class="btn btn-primary btn-sm" id="saveFilesBtn">שמור</button>
      </div>
    </div>
  </div>
</div>
