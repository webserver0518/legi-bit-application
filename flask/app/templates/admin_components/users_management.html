<!-- templates/admin_components/users_management.html -->
<div class="container-fluid py-4">

  <!-- 驻住 住驻转 砖转砖 -->
  <form id="addUserForm"
        class="row g-2 align-items-center justify-content-center">

    <!-- 砖 砖专 -->
    <div class="col-auto form-floating fixed-input">
      <input id="officeName" name="office_name"
             class="form-control form-control-sm"
             placeholder="砖 砖专" required autocomplete="off">
      <label for="officeName">砖 砖专</label>
    </div>

    <!-- 砖 砖转砖 -->
    <div class="col-auto form-floating fixed-input">
      <input id="userName" name="username"
             class="form-control form-control-sm"
             placeholder="砖 砖转砖" required autocomplete="off">
      <label for="userName">砖 砖转砖</label>
    </div>

    <!-- 住住 -->
    <div class="col-auto form-floating fixed-input">
      <input id="userPass" name="password" type="password"
             class="form-control form-control-sm"
             placeholder="住住" required autocomplete="off">
      <label for="userPass">住住</label>
    </div>

    <!-- 转驻拽 -->
    <div class="col-auto form-floating fixed-input position-relative">
      <div class="form-control form-control-sm dropdown-toggle text-start"
           id="userRoleDropdown"
           data-bs-toggle="dropdown"
           aria-expanded="false"
           style="cursor: pointer; background-color: white;">
        专 转驻拽
      </div>
      <ul class="dropdown-menu w-100 p-2" aria-labelledby="userRoleDropdown" style="max-height: 230px; overflow-y: auto;"></ul>
      <label for="userRoleDropdown">转驻拽</label>
    </div>

    <!--  -->
    <div class="col-auto form-floating fixed-input">
      <input id="userEmail" name="email" type="email"
             class="form-control form-control-sm"
             placeholder="" autocomplete="off">
      <label for="userEmail"></label>
    </div>

    <!-- 驻转专 住祝 -->
    <div class="col-auto d-grid">
      <button class="btn btn-add btn-primary btn-sm small-btn">住祝</button>
    </div>
  </form>

  <hr>

  <!-- 转 砖转砖 -->
  <table id="usersTable" class="text-center align-middle w-100">
    <thead>
      <tr>
        <th>砖 砖专</th>
        <th>砖 砖转砖</th>
        <th>转驻拽</th>
        <th></th>
        <th>转专 爪专</th>
        <th>注专</th>
        <th>拽</th>
      </tr>
    </thead>
    <tbody>
      {% for user in users %}
      <tr data-username="{{ user.username }}"
          data-office-serial="{{ user.office_serial }}"
          data-office-name="{{ user.office_name }}">

        <td>{{ user.office_name }}</td>
        <td>{{ user.username }}</td>

        <td>{{ ', '.join(user.roles_hebrew) if user.roles_hebrew else '' }}</td>
        <td>{{ user.email }}</td>
        <td>{{ user.created_at }}</td>

        <td>
          <button class="btn btn-secondary btn-sm small-btn"
                  onclick="openEditUserModal(this)">注专</button>
        </td>

        <!-- Delete -->
        <td>
          {% if 'admin' not in user.roles %}
          <button class="btn btn-delete btn-sm small-btn"
                  onclick="deleteUser(this)"></button>
          {% else %} --- {% endif %}
        </td>

      </tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- Ь Modal 注专转 砖转砖 -->
<div class="modal fade" id="editUserModal" tabindex="-1" aria-labelledby="editUserModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title" id="editUserModalLabel">注专转 砖转砖</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>

      <div class="modal-body">
        <form id="editUserForm" class="row g-2 align-items-center justify-content-center">
          <input type="hidden" name="action" value="edit">
          <input type="hidden" name="office_serial" id="editOfficeSerial">
          <input type="hidden" name="username" id="editUsername" autocomplete="off">

          <!-- 砖 砖专 -->
          <div class="col-auto form-floating fixed-input">
            <input id="editOfficeName" name="office_name"
                   class="form-control form-control-sm"
                   placeholder="砖 砖专" required autocomplete="off">
            <label for="editOfficeName">砖 砖专</label>
          </div>

          <!-- 住住 砖 -->
          <div class="col-auto form-floating fixed-input">
            <input id="editPassword" name="password" type="password"
                   class="form-control form-control-sm"
                   placeholder="住住 砖" autocomplete="off">
            <label for="editPassword">住住 砖</label>
          </div>

          <!-- 转驻拽 -->
          <div class="col-auto form-floating fixed-input position-relative">
            <div class="form-control form-control-sm dropdown-toggle text-start"
                 id="editUserRoleDropdown"
                 data-bs-toggle="dropdown"
                 aria-expanded="false"
                 style="cursor: pointer; background-color: white;">
              专 转驻拽
            </div>

            <ul class="dropdown-menu w-100 p-2" aria-labelledby="editUserRoleDropdown"
                style="max-height: 230px; overflow-y: auto;">
            </ul>

            <label for="editUserRoleDropdown">转驻拽</label>
          </div>

          <!--  -->
          <div class="col-auto form-floating fixed-input">
            <input id="editEmail" name="email" type="email"
                   class="form-control form-control-sm"
                   placeholder="" autocomplete="off">
            <label for="editEmail"></label>
          </div>
        </form>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal"></button>
        <button type="button" class="btn btn-primary btn-sm" id="saveEditUserBtn">注</button>
      </div>
    </div>
  </div>
</div>


</div>
